<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >  
<mapper namespace="com.dly.app.dao.MediaDAO" >  
	<select id="getMoudles"  resultType="com.dly.app.pojo.Image">
	SELECT m.id id,m.title title,i.image_url image_url,i.width width,i.height height FROM t_moudle m JOIN t_image i ON m.image_id=i.id
 	</select>
 	
 	<select id="getGroupsByMoudleId" parameterType="com.dly.app.pojo.Group"  resultType="com.dly.app.pojo.Group">
SELECT g.id id,g.title title,g.text text,g.image_id image_id ,g.istp istp ,g.video_url video_url,i.image_url image_url,i.height height, i.width width
	 	 FROM t_group g JOIN t_image i  ON g.image_id=i.id    WHERE g.moudle_id=#{moudleId} LIMIT #{index},#{size}
 	</select>
 	
 	<select id="getGroupByGroupId" parameterType="String" resultType="com.dly.app.pojo.Image">
	 	SELECT i.id id,i.group_id group_id, i.image_url image_url,i.image_name image_name,i.width width,i.height height
	 	FROM t_group g JOIN t_image i ON g.id=i.group_id WHERE g.id=#{groupId}
 	</select>
 	
 
 	<select id="getGroups" parameterType="com.dly.app.pojo.Group" resultType="com.dly.app.pojo.Group">
 	SELECT	 *  FROM t_group LIMIT #{index},#{size}
 	</select>
 	
 	<insert id="addImage" parameterType="com.dly.app.pojo.Image" >
	 	INSERT INTO t_image (image_url,image_name,width,height,type,title)
	VALUE (#{imageUrl},#{imageName},#{width},#{height},#{type},#{title})
 	</insert>
 	<select id="search" parameterType="String" resultType="com.dly.app.pojo.Group">
 		SELECT *  FROM  t_group WHERE title LIKE #{text}
 	</select>
 	<insert id="userAddCollect" parameterType="com.dly.app.pojo.Collect" >
 		INSERT INTO  t_collect (user_id,group_id) VALUE(#{userId},#{groupId})
 	</insert>
 	<select id="getCollectByUserId"  parameterType="com.dly.app.pojo.Collect" >
 		SELECT  *  FROM  t_collect WHERE user_id=#{userId}
 	</select>
 	<select id="getImages"  resultType="com.dly.app.pojo.Image" >
 		SELECT * FROM t_image where type='0'
 	</select>
 	<delete id="deleteImageById" parameterType="String" >
 		DELETE FROM  t_image WHERE id =#{id}
 	</delete>
 	<select id="getImageById"  parameterType="String"  resultType="com.dly.app.pojo.Image" >
 		SELECT * FROM t_image where id=#{id}
 	</select>
 	<select id="getRegion"  parameterType="com.dly.app.pojo.Region">
 		SELECT  city.id  city_id ,city.name city_name,county.id county_id ,county.name county_name FROM t_city city JOIN t_county  county ON city.id=county.city_id
 	</select>
 	
 
</mapper>  